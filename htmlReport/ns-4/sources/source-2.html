


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > MedicalRecordRepository</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.safetyNet.alerts.api.repository</a>
</div>

<h1>Coverage Summary for Class: MedicalRecordRepository (com.safetyNet.alerts.api.repository)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">MedicalRecordRepository</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (6/6)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (50/50)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package com.safetyNet.alerts.api.repository;
&nbsp;
&nbsp;import com.safetyNet.alerts.api.entity.MedicalRecord;
&nbsp;import com.safetyNet.alerts.api.util.ReadDataFromJson;
&nbsp;import org.json.simple.JSONArray;
&nbsp;import org.json.simple.JSONObject;
&nbsp;import org.json.simple.parser.ParseException;
&nbsp;import org.slf4j.Logger;
&nbsp;import org.slf4j.LoggerFactory;
&nbsp;import org.springframework.stereotype.Repository;
&nbsp;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.List;
&nbsp;import java.util.Optional;
&nbsp;
&nbsp;
&nbsp;@Repository
&nbsp;public class MedicalRecordRepository extends ReadDataFromJson {
&nbsp;
<b class="fc">&nbsp;    Logger logger = LoggerFactory.getLogger(MedicalRecordRepository.class);</b>
&nbsp;
<b class="fc">&nbsp;    private final JSONObject medicalRecordJSON = readJsonFile(&quot;D:\\Dev\\SafetyNet-P4\\src\\main\\resources\\dataSafetyNet.json&quot;);</b>
<b class="fc">&nbsp;    JSONArray medicalRecordArray = (JSONArray) medicalRecordJSON.get(&quot;medicalrecords&quot;);</b>
&nbsp;
&nbsp;    /**
&nbsp;     * Constructor
&nbsp;     */
<b class="fc">&nbsp;    public MedicalRecordRepository() throws ParseException {</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * Read - Get one medicalRecord
&nbsp;     *
&nbsp;     * @param id - The id of the medicalRecord to retrieve
&nbsp;     * @return - An Optional medicalRecord if found, otherwise empty
&nbsp;     */
&nbsp;    public Optional&lt;MedicalRecord&gt; findById(Long id) throws ParseException {
&nbsp;
<b class="fc">&nbsp;        JSONObject recordObj = (JSONObject) medicalRecordArray.get(Math.toIntExact(id));</b>
<b class="fc">&nbsp;        MedicalRecord medicalRecord = new MedicalRecord(</b>
&nbsp;                // Extract and convert properties from recordObj to corresponding MedicalRecord fields.
<b class="fc">&nbsp;                (String) recordObj.get(&quot;firstName&quot;),</b>
<b class="fc">&nbsp;                (String) recordObj.get(&quot;lastName&quot;),</b>
<b class="fc">&nbsp;                (String) recordObj.get(&quot;birthdate&quot;),</b>
<b class="fc">&nbsp;                (String[]) ((JSONArray) recordObj.get(&quot;medications&quot;)).toArray(new String[0]),</b>
<b class="fc">&nbsp;                (String[]) ((JSONArray) recordObj.get(&quot;allergies&quot;)).toArray(new String[0])</b>
&nbsp;        );
<b class="fc">&nbsp;        logger.info(&quot;MedicalRecord retrieved successfully&quot;);</b>
<b class="fc">&nbsp;        return Optional.of(medicalRecord);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Read - Get all medicalRecords
&nbsp;     *
&nbsp;     * @return - An Iterable object of medicalRecords
&nbsp;     */
&nbsp;    public List&lt;MedicalRecord&gt; findAll() throws ParseException {
<b class="fc">&nbsp;        JSONArray medicalRecorsArray = (JSONArray) medicalRecordJSON.get(&quot;medicalrecords&quot;);</b>
<b class="fc">&nbsp;        List&lt;MedicalRecord&gt; medicalRecordsList = new ArrayList&lt;&gt;();</b>
&nbsp;
&nbsp;//         Assuming MedicalRecord class has a constructor that takes relevant properties as arguments.
<b class="fc">&nbsp;        for (Object o : medicalRecorsArray) {</b>
<b class="fc">&nbsp;            JSONObject recordObj = (JSONObject) o;</b>
<b class="fc">&nbsp;            MedicalRecord medicalRecord = new MedicalRecord(</b>
&nbsp;                    // Extract and convert properties from recordObj to corresponding MedicalRecord fields.
<b class="fc">&nbsp;                    (String) recordObj.get(&quot;firstName&quot;),</b>
<b class="fc">&nbsp;                    (String) recordObj.get(&quot;lastName&quot;),</b>
<b class="fc">&nbsp;                    (String) recordObj.get(&quot;birthdate&quot;),</b>
<b class="fc">&nbsp;                    (String[]) ((JSONArray) recordObj.get(&quot;medications&quot;)).toArray(new String[0]),</b>
<b class="fc">&nbsp;                    (String[]) ((JSONArray) recordObj.get(&quot;allergies&quot;)).toArray(new String[0])</b>
&nbsp;            );
<b class="fc">&nbsp;            medicalRecordsList.add(medicalRecord);</b>
<b class="fc">&nbsp;            logger.info(&quot;MedicalRecord added successfully&quot;);</b>
<b class="fc">&nbsp;        }</b>
&nbsp;
<b class="fc">&nbsp;        return medicalRecordsList;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @param lastName  lastName is a filter used as identifier
&nbsp;     * @param firstName firtName is a filter used as identifier
&nbsp;     */
&nbsp;    public void deleteById(String lastName, String firstName) {
&nbsp;
<b class="fc">&nbsp;        JSONObject recordObj = (JSONObject) medicalRecordArray.stream()</b>
<b class="fc">&nbsp;                .filter(medicalRecord -&gt; ((JSONObject) medicalRecord).get(&quot;lastName&quot;).equals(lastName) &amp;&amp;</b>
<b class="fc">&nbsp;                        ((JSONObject) medicalRecord).get(&quot;firstName&quot;).equals(firstName)).findFirst().get();</b>
<b class="fc">&nbsp;        medicalRecordArray.remove(recordObj);</b>
<b class="fc">&nbsp;        logger.info(&quot;MedicalRecord deleted successfully&quot;);</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @param medicalRecord Body Request
&nbsp;     * @return Saved Medical Record
&nbsp;     */
&nbsp;    public MedicalRecord save(MedicalRecord medicalRecord) {
<b class="fc">&nbsp;        JSONObject jsonObject = new JSONObject();</b>
<b class="fc">&nbsp;        jsonObject.put(&quot;firstName&quot;, medicalRecord.getFirstName());</b>
<b class="fc">&nbsp;        jsonObject.put(&quot;lastName&quot;, medicalRecord.getLastName());</b>
<b class="fc">&nbsp;        jsonObject.put(&quot;birthdate&quot;, medicalRecord.getBirthdate());</b>
<b class="fc">&nbsp;        jsonObject.put(&quot;medications&quot;, medicalRecord.getMedications());</b>
<b class="fc">&nbsp;        jsonObject.put(&quot;allergies&quot;, medicalRecord.getAllergies());</b>
<b class="fc">&nbsp;        logger.info(&quot;MedicalRecord saved successfully&quot;);</b>
<b class="fc">&nbsp;        return medicalRecord;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * @param id            index of array
&nbsp;     * @param medicalRecord Body request
&nbsp;     * @return updated Medical Record
&nbsp;     */
&nbsp;    public MedicalRecord update(Long id, MedicalRecord medicalRecord) {
<b class="fc">&nbsp;        JSONObject recordObj = (JSONObject) medicalRecordArray.get(Math.toIntExact(id));</b>
<b class="fc">&nbsp;        MedicalRecord newMedicalRecord = new MedicalRecord(</b>
&nbsp;                // Extract and convert properties from recordObj to corresponding MedicalRecord fields.
<b class="fc">&nbsp;                medicalRecord.getFirstName(),</b>
<b class="fc">&nbsp;                medicalRecord.getLastName(),</b>
<b class="fc">&nbsp;                medicalRecord.getBirthdate(),</b>
<b class="fc">&nbsp;                medicalRecord.getMedications(),</b>
<b class="fc">&nbsp;                medicalRecord.getAllergies()</b>
&nbsp;        );
<b class="fc">&nbsp;        logger.info(&quot;MedicalRecord updated successfully&quot;);</b>
<b class="fc">&nbsp;        save(medicalRecord);</b>
<b class="fc">&nbsp;        return newMedicalRecord;</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-09-15 10:40</div>
</div>
</body>
</html>
